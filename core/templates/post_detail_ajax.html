{% extends 'base.html' %}
{% block title %}post_ajax{% endblock %}

{% block content %}
<div class="col-md-8 m-auto p-2 mb-5">
    <!-- header of post -->
    <div class="mb-2 text-center p-2">
        <h1 class="col-12 fw-bolder mb-1 text-primary text-center"><strong class="card-title fst-italic ">{{ post.title }}</strong></h1>
    </div>
    <!-- info of post -->
    <div class="bg-light p-2 mb-3">
        <div class="text-muted fst-italic mb-2"> <small>Posted on {{ post.created }} | by {{ post.author.first_name }}
                {{ post.author.last_name }}</small></div>
        <a href="#"><span class="badge rounded-pill bg-primary">
                <small class="card-title ">{{ post.slug }}</small>
            </span>
        </a>
    </div>
    <!-- body of post -->
    <div class="d-flex row p-2">
        <div class="image mb-3"><img src="{{ post.image.url }}" alt="Post Image" class="card-img-top img-fluid"></div>
        <div class="body mb-3">
            {{ post.body }}
        </div>
        <div class="footer mb-4 d-flex justify-content-end">
            {% if user.is_authenticated and user.id == post.author.id %}
            <form action="{% url 'delete_post' post.post_id %}" method="post">
                {% csrf_token %}
                <button type="button" class="btn btn-danger me-2" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal-{{ post.post_id }}">Delete</button>
            </form>
            <a href="{% url 'update_post' pk=post.post_id %}" class="btn btn-warning">Update</a>
            {% endif %}
        </div>
         <!-- Confirmation Modal for Delete Post -->
         <div class="modal fade" id="confirmDeleteModal-{{ post.post_id }}" tabindex="-1" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-body my-2">
                        Are you sure you want to delete this Post?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <form action="{% url 'delete_post' post.post_id %}" method="post">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-danger"
                            name="delete_button" ><i class="bi bi-trash"> </i> Delete
                                </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- assessment section -->
        <div class="d-flex mb-3" >
            <div id="like_unlike_button">
                <!-- info of likes and unlikes -->
                
                <!-- info of likes and unlikes -->
            </div>
            <button class="btn btn-light share-btn mx-2" data-comment-id="{{ post.post_id }}">
                <a href="{% url 'share_facebook' %}" target="_blank"><i class="bi bi-share"></i> Share</a>
            </button>
            <div class="d-flex justify-content-center align-items-center mx-2" data-comment-id="{{ post.post_id }}">
                <i class="bi bi-eye-fill px-2"></i><div class="total_view">{{ post.views }}</div>
            </div>            
        </div>
    </div>
    <!-- comment section -->
    <p class="d-inline-flex gap-1">
        <button id="show_data" data-post-id="{{ post.pk }}" class="btn btn-light" type="button" data-bs-toggle="collapse" data-bs-target=".multi-collapse" aria-expanded="false" aria-controls="multiCollapseExample1 multiCollapseExample2">Comments ({{ comments_count }})</button>
    </p>
    <div class="container p-1 mb-2 collapse multi-collapse">
            <div class="container-header p-1">
                <!-- Comment form - only shown to authenticated users -->
                {% if user.is_authenticated %}
                <form id="comment-form" class="mb-4" data-post-id="{{ post.post_id }}" method="post">
                    <textarea class="form-control" id="comment-content" name="content" rows="3" placeholder="add comment..." required></textarea>
                    <div class="d-flex justify-content-end">
                        <button type="submit" class="btn btn-primary m-2 " name="add_comment" id="add-comment-btn" >Add</button>
                    </div>
                </form>
                {% endif %}
            </div>
            <div class="container-body mb-2" id="comments_box">
                <!-- List all comments/reply comments -->

                <!-- List all comments/reply comments -->
            </div>
            
    </div>
</div>
<div class="container my-5 ">

</div>
{% endblock %}